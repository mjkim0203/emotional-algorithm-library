<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>MQTT Video Player</title>
  <style>
    body {
      margin: 0;
      background-color: black;
    }
    video {
      width: 100vw;
      height: 100vh;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <video id="player" autoplay muted playsinline></video>

  <!-- MQTT ÎùºÏù¥Î∏åÎü¨Î¶¨ (CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/paho-mqtt.min.js"></script>
  <script>
    const client = new Paho.MQTT.Client("test.mosquitto.org", 8081, "/mqtt", "player-" + Math.random());
    const topic = "sample/goldstar/display";

    const player = document.getElementById("player");

    client.onConnectionLost = (response) => {
      console.warn("‚ö†Ô∏è Ïó∞Í≤∞ ÎÅäÍπÄ:", response.errorMessage);
    };

    client.onMessageArrived = (message) => {
      const url = message.payloadString;
      console.log("üé• Ïû¨ÏÉùÌï† URL ÏàòÏã†Îê®:", url);
      player.src = url;
      player.load();
      player.play().then(() => {
        console.log("‚ñ∂ ÎπÑÎîîÏò§ Ïû¨ÏÉù ÏãúÏûë");
      }).catch(err => {
        console.error("‚ùå Ïû¨ÏÉù Ïã§Ìå®:", err);
      });
    };

    client.connect({
      useSSL: true,
      onSuccess: () => {
        console.log("‚úÖ MQTT Ïó∞Í≤∞ ÏÑ±Í≥µ (PLAYER)");
        client.subscribe(topic);
        console.log("üì° ÌÜ†ÌîΩ Íµ¨ÎèÖ ÏôÑÎ£å:", topic);
      },
      onFailure: (e) => {
        console.error("‚ùå MQTT Ïó∞Í≤∞ Ïã§Ìå®", e);
      }
    });
  </script>
</body>
</html>
