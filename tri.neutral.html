<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê°ì • ë¶„ì„ ê²°ê³¼</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="tri.neutral.css" />
</head>

  
 <button class="next-button" onclick="sendNextMessage()">next â†’</button>

<script>
  function sendNextMessage() {
    const videoUrl = "https://mjkim0203.github.io/emotional-algorithm-library/videos/neutral.mp4";
    const client = new Paho.MQTT.Client("wss://test.mosquitto.org:8081/mqtt", "sender-" + Math.random());
    const topic = "sample/goldstar/display";

    client.connect({
      onSuccess: () => {
        const message = new Paho.MQTT.Message(videoUrl);
        message.destinationName = topic;
        client.send(message);
        console.log("ğŸ“¤ ë©”ì‹œì§€ ì „ì†¡ë¨:", videoUrl);
      },
      useSSL: true,
      onFailure: e => console.error("âŒ MQTT ì—°ê²° ì‹¤íŒ¨:", e)
    });
  }
</script>



<body>

  <!-- ìƒë‹¨ ë¡¤ë§ë°” -->
  <div class="top-bar">
    <div class="scroll-wrapper">
      <div class="scroll-text">
        HOW ALGORITHM U FEELING TODAY?&nbsp;&nbsp;&nbsp; HOW ALGORITHM U FEELING TODAY?&nbsp;&nbsp;&nbsp; HOW ALGORITHM U FEELING TODAY?
      </div>
    </div>
  </div>

  <!-- ë©”ì¸ í™”ë©´ ì»¨í…Œì´ë„ˆ -->
  <div class="screen-container">
    
    <!-- í™”ë©´1 : ë¶„ì„ ì¤‘ + ì™„ë£Œ -->
    <div class="screen screen1 show">
      <div class="title" id="title">ê°ì • ë¶„ì„í•˜ëŠ” ì¤‘ . . .</div>
      <div class="subtitle" id="subtitle">ì§€ê¸ˆ ê°ì •ì„ ë¶„ì„í•˜ê³  ìˆì–´ìš”</div>

      <div class="circles">
        <div class="circle1"></div>
        <div class="circle2"></div>
        <div class="circle3"></div>
      </div>

      <div class="emotion-eng-wrapper" id="emotionEngWrapper">
        <img src="https://cdn.glitch.global/b5dd1b0e-2595-4522-b3c9-fac2d8d11eb4/CAPTURE-100.png?v=1751441474929" alt="left bracket" class="bracket-img left">
        <div class="emotion-eng" id="emotionEng">Neutral</div>
        <img src="https://cdn.glitch.global/b5dd1b0e-2595-4522-b3c9-fac2d8d11eb4/CAPTURE-100.png?v=1751441474929" alt="right bracket" class="bracket-img right">
      </div>

      <!-- âœ… í”„ë¡œê·¸ë ˆìŠ¤ ë°”ëŠ” í™”ë©´1 ë‚´ë¶€ì— ê³ ì • -->
      <div class="progress-wrapper">
        <div class="progress-bar" id="progressBar"></div>
      </div>
    </div>

    <!-- í™”ë©´2 : ì‚¬ìš©ì ì •ë³´ -->
    <div class="background-image"></div>
    <div class="gradient-overlay"></div>

    <div class="screen screen2">
      <div class="notice-text">ì´ì œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ì£¼ì„¸ìš”!</div>

      <!-- ê°ì • ê·¸ë˜í”½ -->
      <div class="graphic-box">
        <img src="https://i.ibb.co/nN8fWqMc/GRAPHIC-100.png" alt="emotion graphic" class="graphic-img" />
      </div>

      <!-- ì‚¬ìš©ìì •ë³´ -->
      <div class="info-block">
        <div class="info-row">
          <img src="https://i.ibb.co/VcCFXKvB/g-100.png" class="emoji-img" />
          <div class="label">User Name</div>
        </div>
        <div class="value" id="user-name">ì´ë¦„</div>

        <div class="divider"></div>

        <div class="info-row">
          <img src="https://i.ibb.co/VcCFXKvB/g-100.png" class="emoji-img" />
          <div class="label">Emotion</div>
        </div>
        <div class="value emotion-value" id="emotion-ko">ì¤‘ë¦½</div>

        <div class="page-buttons">
           <button onclick="location.href='index.html'" class="home-button">â† home</button>
            <button class="next-button"
        onclick="sendMQTTMessageAndGoNext()">
  next â†’
</button>
        </div>
   
       <audio id="triggerAudio" preload="auto"></audio>


      </div>
    </div>
  </div>

  <!-- âœ… í•˜ë‹¨ ê³ ì • ë¡œê³ ë§Œ ë³„ë„ë¡œ -->
  <div class="fixed-logo">
    <img src="https://i.ibb.co/JWZj7K9v/LOGO-1.png" class="logo-img" />
  </div>

<!-- 1) Paho MQTT WebSocket í´ë¼ì´ì–¸íŠ¸ -->
<script src="js/paho-mqtt.min.js"></script>
  <!-- 2) TTContainer ë˜í¼ -->
  <script src="js/TTContainer.js"></script>

<script>
    // âœ… MQTT ì—°ê²° ì´ˆê¸°í™”
    window.addEventListener('load', () => {
    ttContainer.mqttConnect(
      "sample",
      "display",
      () => console.log("âœ… MQTT ì—°ê²° ì™„ë£Œ (tri.fear.html)"),
      { brokerUrl: "wss://test.mosquitto.org:8081/mqtt" }
    );
  });

  function sendMQTTMessageAndGoNext() {
    const url = "https://mjkim0203.github.io/emotional-algorithm-library/videos/neutral.mp4";
    ttContainer.sendMessage(url);
    console.log("âœ… MQTT ë©”ì‹œì§€ ì „ì†¡ë¨:", url);
  }
  </script>


  <script src="trigger.js"></script>
  <script src="socket.js"></script>

</body>
</html>
